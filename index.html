<!DOCTYPE html>
<html>
  <head>
    <script src="https://cloudboost.io/js-sdk/cloudboost.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

  </head>
  <style>
    body {
      padding-left: 30px;
      padding-right: 20px;
      padding-top: 10px;
      padding-bottom: 20px;
    }
    .input {
      height: 25px;
      width: 200px;
    }
    button {
      height: 25px;
      width: 150px;
    }
  </style>
  <body>
    <h4>
      <input id="user" placeholder="Username" width="70" class="input">
      <input id="password" placeholder="Password" class="input" type="password">
      <input id="email" placeholder="email@example.com" class="input">
      <br>
      <button id="login">Login</button>
      <button id="newUser">Create User</button>
      <div id="account">
      
        <button id="editprofile"> Edit Profile:</button>
        <br>
        <br>
        <table>
          <tr>
            <th>Username</th>
            <th><input id="username"></th>
          </tr>  
          <tr>
            <th>Password</th>
            <th><input id="pword"></th>
          </tr>
          <tr>
            <th>Home Address </th>
            <th><input id="address"></th>
          </tr>
          <tr>
            <th>Places</th>
            <th>You can only delete places on the login page<input id="Places"></th>
          </tr>
          </table>
        <br>
        <a href='/Marioisdabest/nha-oop-fall-2016/final-projec/user.html'>Continue to main site</a>
      </div>
    </h4>
    
    <script>
      let usercontent
      $("#login").click(event => {
        CB.CloudApp.init('nbnikckfyceg', 'a027eaea-2e61-4c9a-b1b8-21cdb080bd66');
        let username=$("#user").val();
        let password=$("#password").val();
        let email=$("#email").val();
        let user = new CB.CloudUser();
        user.set('username', username);
        user.set('password', password);
        user.set('email', email);
        usercontent=user
        user.logIn({
          success: function(data){
            console.log(data)
            $("#username").val()=data.get("username")
            $("#pword").val()=data.get("password")
            $("#address").val()=data.get("address")
          },
          error: function(err){
            console.log(err)
            alert("Wrong User, Password, or email")
          }
        })
      })
      $("#newUser").click(event => {
        CB.CloudApp.init('nbnikckfyceg', 'a027eaea-2e61-4c9a-b1b8-21cdb080bd66');
        let username=$("#user").val();
        let password=$("#password").val();
        let email=$("#email").val();
        console.log(user, password)
        let home= new CB.CloudGeoPoint(40,-74);
        let latestuser= new CB.CloudUser;
        latestuser.set("username",username)
        latestuser.set("password",password)
        latestuser.set("email",email)
        latestuser.set("home",home)
        latestuser.signUp({
          success: function(savemessage){
            console.log(savemessage)
          },
          error: function(errormessage){
            console.log(errormessage)
          }
        })
      })
      $("#editprofile").click(event => {
        usercontent.fetch({
        success: function(obj){
        let username=$("#user").val();
        let password=$("#password").val();
        let email=$("#email").val();
        let user = new CB.CloudUser();
        obj.set('username', username);
        obj.set('password', password);
        obj.set('email', email);
        obj.save({
        success: function(){
          console.log("data saved")
        },
        error: function(){
        
        }
          
          
        })
          
        },
        error: function(){
        },
        })
        
      });
      
    </script>
  </body>
</html>
